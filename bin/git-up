#!/bin/sh
#
# Usage: git-up
#        git-reup
#
# Like git-pull but show a short and sexy log of changes
# immediately after merging (git-up) or rebasing (git-reup).
#
# Inspired by Kyle Neath's `git up' alias:
# http://gist.github.com/249223
#
# Stolen from Ryan Tomayko
# http://github.com/rtomayko/dotfiles/blob/rtomayko/bin/git-up
#
# Edited by Alex Hokanson

set -e

PULL_ARGS="$@"

remote_name='upstream'
if ! git remote 2>&1 | grep 'upstream' 2>&1 > /dev/null;
then
    remote_name='origin'
fi

if [[ -z $PULL_ARGS ]];
then
    PULL_ARGS="${remote_name} main"
fi

git pull --no-edit $PULL_ARGS

# show an abbreviated commit log of stuff that was just merged.
echo "Log:"
#git log --color --pretty=oneline --abbrev-commit HEAD@{1}.. |
git log --color --pretty=tformat:'%C(yellow)%h %C(red)%an %C(reset)%s' --abbrev-commit HEAD@{1}.. |
sed 's/^/  /'
